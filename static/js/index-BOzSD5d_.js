var ae=Object.defineProperty;var K=Object.getOwnPropertySymbols;var ne=Object.prototype.hasOwnProperty,ue=Object.prototype.propertyIsEnumerable;var G=(e,r,t)=>r in e?ae(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,O=(e,r)=>{for(var t in r||(r={}))ne.call(r,t)&&G(e,t,r[t]);if(K)for(var t of K(r))ue.call(r,t)&&G(e,t,r[t]);return e};var L=(e,r,t)=>new Promise((V,d)=>{var h=i=>{try{o(t.next(i))}catch(f){d(f)}},m=i=>{try{o(t.throw(i))}catch(f){d(f)}},o=i=>i.done?V(i.value):Promise.resolve(i.value).then(h,m);o((t=t.apply(e,r)).next())});import{S as re}from"./sortable.esm-CkCitmyH.js";import{d as ie,a as s,Z as oe,am as R,ag as v,p as $,i as l,a5 as ce,F as M,B as k,A as p,e as u,h as S,u as P,ac as B,fL as se,fD as de,aD as fe,aN as ve,y as me,Y as xe}from"./index-DPW8Wnaw.js";import{u as he}from"./epTheme-CKLCAVmH.js";import{E as be,R as ge,C as Ce,D as ye,S as ke}from"./collapse-CeAQJohj.js";function pe(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!fe(e)}const we={title:{type:String,default:"列表"},vxeTableRef:{type:Object},columns:{type:Array,default:()=>[]},tree:{type:Boolean,default:!1},isExpandAll:{type:Boolean,default:!0},tableKey:{type:[String,Number],default:"0"}},Te=ie({name:"VxeTableBar",props:we,emits:["refresh"],setup(e,{emit:r,slots:t,attrs:V}){const d=s("small"),h=s(!1),m=s(!0),o=s(!1),i=s(!1),f=oe(),b=s(e.isExpandAll);let x=R(v(e==null?void 0:e.columns),"title");const g=s(R(v(e==null?void 0:e.columns),"title")),c=s(v(e==null?void 0:e.columns)),A=$(()=>a=>({background:a===d.value?he().epThemeColor:"",color:a===d.value?"#fff":"var(--el-text-color-primary)"})),C=$(()=>["text-black","dark:text-white","duration-100","hover:!text-primary","cursor-pointer","outline-none"]),H=$(()=>["flex","justify-between","pt-[3px]","px-[11px]","border-b-[1px]","border-solid","border-[#dcdfe6]","dark:border-[#303030]"]);function U(){h.value=!0,r("refresh"),ve(500).then(()=>h.value=!1)}function Y(){b.value=!b.value,b.value?e.vxeTableRef.setAllTreeExpand(!0):e.vxeTableRef.clearTreeExpand(),e.vxeTableRef.refreshColumn()}function j(){const a=v(c.value).filter(n=>g.value.includes(n.title));e.vxeTableRef.reloadColumn(a)}function Z(a){g.value=a?x:[],i.value=!1,j()}function q(a){g.value=a;const n=a.length;m.value=n===x.length,i.value=n>0&&n<x.length}function J(){return L(this,null,function*(){m.value=!0,i.value=!1,c.value=v(e==null?void 0:e.columns),x=[],x=yield R(v(e==null?void 0:e.columns),"title"),g.value=R(v(e==null?void 0:e.columns),"title"),e.vxeTableRef.refreshColumn()})}function F(a){d.value=a,e.vxeTableRef.refreshColumn()}const Q={dropdown:()=>l(u("el-dropdown-menu"),{class:"translation"},{default:()=>[l(u("el-dropdown-item"),{style:A.value("medium"),onClick:()=>F("medium")},{default:()=>[S("宽松")]}),l(u("el-dropdown-item"),{style:A.value("small"),onClick:()=>F("small")},{default:()=>[S("默认")]}),l(u("el-dropdown-item"),{style:A.value("mini"),onClick:()=>F("mini")},{default:()=>[S("紧凑")]})]})},W=a=>{a.preventDefault(),me(()=>{var T;const n=((T=f==null?void 0:f.proxy)==null?void 0:T.$refs[`VxeGroupRef${P(e.tableKey)}`]).$el.firstElementChild;re.create(n,{animation:300,handle:".drag-btn",onEnd:({newIndex:y,oldIndex:E,item:le})=>{const N=le,_=N.parentNode,z=c.value[E],I=c.value[y];if(z!=null&&z.fixed||I!=null&&I.fixed){const D=_.children[E];y>E?_.insertBefore(N,D):_.insertBefore(N,D&&D.nextElementSibling);return}const te=c.value.splice(E,1)[0];c.value.splice(y,0,te),j()}})})},X=a=>!!c.value.filter(n=>B(n.title)===B(a))[0].fixed,w=a=>({content:a,offset:[0,18],duration:[300,0],followCursor:!0,hideOnClick:"toggle"}),ee={reference:()=>k(l(ke,{class:["w-[16px]",C.value]},null),[[p("tippy"),w("列设置")]])};return()=>{let a;return l(M,null,[l("div",ce(V,{class:["w-[99/100]","px-2","pb-2","bg-bg_color",o.value?["!w-full","!h-full","z-[2002]","fixed","inset-0"]:"mt-2"]}),[l("div",{class:"flex justify-between w-full h-[60px] p-4"},[t!=null&&t.title?t.title():l("p",{class:"font-bold truncate"},[e.title]),l("div",{class:"flex items-center justify-around"},[t!=null&&t.buttons?l("div",{class:"flex mr-4"},[t.buttons()]):null,e.tree?l(M,null,[k(l(be,{class:["w-[16px]",C.value],style:{transform:b.value?"none":"rotate(-90deg)"},onClick:()=>Y()},null),[[p("tippy"),w(b.value?"折叠":"展开")]]),l(u("el-divider"),{direction:"vertical"},null)]):null,k(l(ge,{class:["w-[16px]",C.value,h.value?"animate-spin":""],onClick:()=>U()},null),[[p("tippy"),w("刷新")]]),l(u("el-divider"),{direction:"vertical"},null),k(l(u("el-dropdown"),{trigger:"click"},O({default:()=>[l(Ce,{class:["w-[16px]",C.value]},null)]},Q)),[[p("tippy"),w("密度")]]),l(u("el-divider"),{direction:"vertical"},null),l(u("el-popover"),{placement:"bottom-start","popper-style":{padding:0},width:"200",trigger:"click"},O({default:()=>[l("div",{class:[H.value]},[l(u("el-checkbox"),{class:"!-mr-1",label:"列展示",modelValue:m.value,"onUpdate:modelValue":n=>m.value=n,indeterminate:i.value,onChange:n=>Z(n)},null),l(u("el-button"),{type:"primary",link:!0,onClick:()=>J()},{default:()=>[S("重置")]})]),l("div",{class:"pt-[6px] pl-[11px]"},[l(u("el-scrollbar"),{"max-height":"36vh"},{default:()=>[l(u("el-checkbox-group"),{ref:`VxeGroupRef${P(e.tableKey)}`,modelValue:g.value,onChange:n=>q(n)},{default:()=>[l(u("el-space"),{direction:"vertical",alignment:"flex-start",size:0},pe(a=x.map((n,T)=>l("div",{class:"flex items-center"},[l(ye,{class:["drag-btn w-[16px] mr-2",X(n)?"!cursor-no-drop":"!cursor-grab"],onMouseenter:y=>W(y)},null),l(u("el-checkbox"),{key:T,label:n,value:n,onChange:j},{default:()=>[l("span",{title:B(n),class:"inline-block w-[120px] truncate hover:text-text_color_primary"},[B(n)])]})])))?a:{default:()=>[a]})]})]})])]},ee)),l(u("el-divider"),{direction:"vertical"},null),k(l(u("iconifyIconOffline"),{class:["w-[16px]",C.value],icon:o.value?se:de,onClick:()=>o.value=!o.value},null),[[p("tippy"),o.value?"退出全屏":"全屏"]])])]),t.default({size:d.value,dynamicColumns:c.value})])])}}}),Ve=xe(Te);export{Ve as V};
