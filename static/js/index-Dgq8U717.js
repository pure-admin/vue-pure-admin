var re=Object.defineProperty;var G=Object.getOwnPropertySymbols;var ue=Object.prototype.hasOwnProperty,ie=Object.prototype.propertyIsEnumerable;var L=(e,o,t)=>o in e?re(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t,K=(e,o)=>{for(var t in o||(o={}))ue.call(o,t)&&L(e,t,o[t]);if(G)for(var t of G(o))ie.call(o,t)&&L(e,t,o[t]);return e};var P=(e,o,t)=>new Promise((V,m)=>{var g=s=>{try{d(t.next(s))}catch(b){m(b)}},h=s=>{try{d(t.throw(s))}catch(b){m(b)}},d=s=>s.done?V(s.value):Promise.resolve(s.value).then(g,h);d((t=t.apply(e,o)).next())});import{S as oe}from"./sortable.esm-C0jtZaAC.js";import{d as ce,l as v,aG as F,ai as x,f as l,a4 as se,ab as u,F as H,A as E,z as T,ef as c,a as i,u as M,eo as de,ee as fe,v as N,aS as ve,x as me,Z as be,aD as xe,W as he}from"./index-LDZGYJqY.js";import{u as pe}from"./epTheme-AiMDJAZ_.js";import{E as Ce,R as ge,C as ye,D as ke,S as we}from"./collapse-3xPHcBKM.js";function S(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!xe(e)}const Be={title:{type:String,default:c("tableBar.pureList")},vxeTableRef:{type:Object},columns:{type:Array,default:()=>[]},tree:{type:Boolean,default:!1},isExpandAll:{type:Boolean,default:!0},tableKey:{type:[String,Number],default:"0"}},Ee=ce({name:"VxeTableBar",props:Be,emits:["refresh","fullscreen"],setup(e,{emit:o,slots:t,attrs:V}){const m=v("small"),g=v(!1),h=v(!0),d=v(!1),s=v(!1),b=be(),y=v(e.isExpandAll);let p=F(x(e==null?void 0:e.columns),"title");const k=v(F(x(e==null?void 0:e.columns),"title")),f=v(x(e==null?void 0:e.columns)),A=N(()=>a=>({background:a===m.value?pe().epThemeColor:"",color:a===m.value?"#fff":"var(--el-text-color-primary)"})),w=N(()=>["text-black","dark:text-white","duration-100","hover:text-primary!","cursor-pointer","outline-hidden"]),U=N(()=>["flex","justify-between","pt-[3px]","px-[11px]","border-b-[1px]","border-b-solid","border-[#dcdfe6]","dark:border-[#303030]"]);function W(){g.value=!0,o("refresh"),ve(500).then(()=>g.value=!1)}function Z(){y.value=!y.value,y.value?e.vxeTableRef.setAllTreeExpand(!0):e.vxeTableRef.clearTreeExpand(),e.vxeTableRef.refreshColumn()}function q(){d.value=!d.value,o("fullscreen",d.value)}function _(){const a=x(f.value).filter(r=>k.value.includes(r.title));e.vxeTableRef.reloadColumn(a)}function J(a){k.value=a?p:[],s.value=!1,_()}function Q(a){k.value=a;const r=a.length;h.value=r===p.length,s.value=r>0&&r<p.length}function X(){return P(this,null,function*(){h.value=!0,s.value=!1,f.value=x(e==null?void 0:e.columns),p=[],p=yield F(x(e==null?void 0:e.columns),"title"),k.value=F(x(e==null?void 0:e.columns),"title"),e.vxeTableRef.refreshColumn()})}function j(a){m.value=a,e.vxeTableRef.refreshColumn()}const Y={dropdown:()=>{let a,r,n;return l(i("el-dropdown-menu"),{class:"translation"},{default:()=>[l(i("el-dropdown-item"),{style:A.value("medium"),onClick:()=>j("medium")},S(a=u(c("tableBar.pureLarge")))?a:{default:()=>[a]}),l(i("el-dropdown-item"),{style:A.value("small"),onClick:()=>j("small")},S(r=u(c("tableBar.pureDefault")))?r:{default:()=>[r]}),l(i("el-dropdown-item"),{style:A.value("mini"),onClick:()=>j("mini")},S(n=u(c("tableBar.pureSmall")))?n:{default:()=>[n]})]})}},ee=a=>{a.preventDefault(),me(()=>{var n;const r=((n=b==null?void 0:b.proxy)==null?void 0:n.$refs[`VxeGroupRef${M(e.tableKey)}`]).$el.firstElementChild;oe.create(r,{animation:300,handle:".drag-btn",onEnd:({newIndex:B,oldIndex:C,item:ae})=>{const z=ae,I=z.parentNode,O=f.value[C],$=f.value[B];if(O!=null&&O.fixed||$!=null&&$.fixed){const D=I.children[C];B>C?I.insertBefore(z,D):I.insertBefore(z,D&&D.nextElementSibling);return}const ne=f.value.splice(C,1)[0];f.value.splice(B,0,ne),_()}})})},le=a=>!!f.value.filter(r=>u(r.title)===u(a))[0].fixed,R=a=>({content:a,offset:[0,18],duration:[300,0],followCursor:!0,hideOnClick:"toggle"}),te={reference:()=>E(l(we,{class:["w-[16px]",w.value]},null),[[T("tippy"),R(u(c("tableBar.pureColumnSettings")))]])};return()=>{let a,r;return l(H,null,[l("div",se(V,{class:["w-full","px-2","pb-2","bg-bg_color",d.value?["h-full!","z-2002","fixed","inset-0"]:"mt-2"]}),[l("div",{class:"flex justify-between w-full h-[60px] p-4"},[t!=null&&t.title?t.title():l("p",{class:"font-bold truncate"},[u(e.title)]),l("div",{class:"flex items-center justify-around"},[t!=null&&t.buttons?l("div",{class:"flex mr-4"},[t.buttons()]):null,e.tree?l(H,null,[E(l(Ce,{class:["w-[16px]",w.value],style:{transform:y.value?"none":"rotate(-90deg)"},onClick:()=>Z()},null),[[T("tippy"),R(y.value?u(c("tableBar.pureCollapse")):u(c("tableBar.pureExpand")))]]),l(i("el-divider"),{direction:"vertical"},null)]):null,E(l(ge,{class:["w-[16px]",w.value,g.value?"animate-spin":""],onClick:()=>W()},null),[[T("tippy"),R(u(c("tableBar.pureRefresh")))]]),l(i("el-divider"),{direction:"vertical"},null),E(l(i("el-dropdown"),{trigger:"click"},K({default:()=>[l(ye,{class:["w-[16px]",w.value]},null)]},Y)),[[T("tippy"),R(u(c("tableBar.pureDensity")))]]),l(i("el-divider"),{direction:"vertical"},null),l(i("el-popover"),{placement:"bottom-start","popper-style":{padding:0},width:"200",trigger:"click"},K({default:()=>[l("div",{class:[U.value]},[l(i("el-checkbox"),{class:"-mr-1!",label:u(c("tableBar.pureColumnDisplay")),modelValue:h.value,"onUpdate:modelValue":n=>h.value=n,indeterminate:s.value,onChange:n=>J(n)},null),l(i("el-button"),{type:"primary",link:!0,onClick:()=>X()},S(a=u(c("tableBar.pureReset")))?a:{default:()=>[a]})]),l("div",{class:"pt-[6px] pl-[11px]"},[l(i("el-scrollbar"),{"max-height":"36vh"},{default:()=>[l(i("el-checkbox-group"),{ref:`VxeGroupRef${M(e.tableKey)}`,modelValue:k.value,onChange:n=>Q(n)},{default:()=>[l(i("el-space"),{direction:"vertical",alignment:"flex-start",size:0},S(r=p.map((n,B)=>l("div",{class:"flex items-center"},[l(ke,{class:["drag-btn w-[16px] mr-2",le(n)?"cursor-no-drop!":"cursor-grab!"],onMouseenter:C=>ee(C)},null),l(i("el-checkbox"),{key:B,label:n,value:n,onChange:_},{default:()=>[l("span",{title:u(n),class:"inline-block w-[120px] truncate hover:text-text_color_primary"},[u(n)])]})])))?r:{default:()=>[r]})]})]})])]},te)),l(i("el-divider"),{direction:"vertical"},null),E(l(i("iconifyIconOffline"),{class:["w-[16px]",w.value],icon:d.value?de:fe,onClick:()=>q()},null),[[T("tippy"),d.value?u(c("tableBar.pureExitFullScreen")):u(c("tableBar.pureFullScreen"))]])])]),t.default({size:m.value,dynamicColumns:f.value})])])}}}),Ve=he(Ee);export{Ve as V};
