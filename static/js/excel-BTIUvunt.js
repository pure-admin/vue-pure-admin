var E=Object.defineProperty,B=Object.defineProperties;var S=Object.getOwnPropertyDescriptors;var x=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var k=(s,e,o)=>e in s?E(s,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):s[e]=o,w=(s,e)=>{for(var o in e||(e={}))V.call(e,o)&&k(s,o,e[o]);if(x)for(var o of x(e))z.call(e,o)&&k(s,o,e[o]);return s},v=(s,e)=>B(s,S(e));import{u as f,w as K}from"./xlsx-CX_Vxrsw.js";import{d as N,a as A,b as j,w as u,e as _,g as h,f as y,u as g,l as m}from"./index-BAFRNKWY.js";const F={class:"font-medium"},J={class:"h-[25rem] mt-3"},q=N({name:"Excel",__name:"excel",setup(s){const e=(l=10,t="column-",n)=>Array.from({length:l}).map((c,a)=>v(w({},n),{key:`${t}${a}`,dataKey:`${t}${a}`,title:`Column ${a}`,width:150})),o=(l,t=200,n="row-")=>Array.from({length:t}).map((c,a)=>l.reduce((r,i,p)=>(r[i.dataKey]=`Row ${a} - Col ${p}`,r),{id:`${n}${a}`,parentId:null})),d=e(10),b=o(d,1e3),$=()=>{const l=b.map(a=>{const r=[];return d.forEach(i=>{r.push(a[i.dataKey])}),r}),t=[];d.forEach(a=>{t.push(a.title)}),l.unshift(t);const n=f.aoa_to_sheet(l),c=f.book_new();f.book_append_sheet(c,n,"数据报表"),K(c,"tableV2.xlsx")};return(l,t)=>{const n=m("el-link"),c=m("el-button"),a=m("el-table-v2"),r=m("el-auto-resizer"),i=m("el-card");return A(),j(i,{shadow:"never"},{header:u(()=>[y("div",F,[_(n,{href:"https://github.com/SheetJS/sheetjs",target:"_blank",style:{margin:"0 5px 4px 0","font-size":"16px"}},{default:u(()=>[...t[0]||(t[0]=[h(" 导出Excel ",-1)])]),_:1})]),_(n,{class:"mt-2",href:"https://github.com/pure-admin/vue-pure-admin/blob/main/src/views/able/excel.vue",target:"_blank"},{default:u(()=>[...t[1]||(t[1]=[h(" 代码位置 src/views/able/excel.vue ",-1)])]),_:1})]),default:u(()=>[_(c,{type:"primary",onClick:$},{default:u(()=>[...t[2]||(t[2]=[h("导出Excel",-1)])]),_:1}),y("div",J,[_(r,null,{default:u(({height:p,width:C})=>[_(a,{columns:g(d),data:g(b),width:C,height:p,fixed:""},null,8,["columns","data","width","height"])]),_:1})])]),_:1})}}});export{q as default};
