var E=Object.defineProperty,B=Object.defineProperties;var S=Object.getOwnPropertyDescriptors;var x=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var k=(s,e,o)=>e in s?E(s,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):s[e]=o,w=(s,e)=>{for(var o in e||(e={}))V.call(e,o)&&k(s,o,e[o]);if(x)for(var o of x(e))z.call(e,o)&&k(s,o,e[o]);return s},v=(s,e)=>B(s,S(e));import{u as h,w as K}from"./xlsx-DpL4DYl1.js";import{d as N,b as j,e as A,w as _,f as i,g as y,j as f,h as m,u as g}from"./index-bnz8hAoG.js";const F={class:"font-medium"},J={class:"h-[25rem] mt-3"},q=N({name:"Excel",__name:"excel",setup(s){const e=(r=10,t="column-",n)=>Array.from({length:r}).map((c,a)=>v(w({},n),{key:`${t}${a}`,dataKey:`${t}${a}`,title:`Column ${a}`,width:150})),o=(r,t=200,n="row-")=>Array.from({length:t}).map((c,a)=>r.reduce((l,u,p)=>(l[u.dataKey]=`Row ${a} - Col ${p}`,l),{id:`${n}${a}`,parentId:null})),d=e(10),b=o(d,1e3),$=()=>{const r=b.map(a=>{const l=[];return d.forEach(u=>{l.push(a[u.dataKey])}),l}),t=[];d.forEach(a=>{t.push(a.title)}),r.unshift(t);const n=h.aoa_to_sheet(r),c=h.book_new();h.book_append_sheet(c,n,"数据报表"),K(c,"tableV2.xlsx")};return(r,t)=>{const n=m("el-link"),c=m("el-button"),a=m("el-table-v2"),l=m("el-auto-resizer"),u=m("el-card");return A(),j(u,{shadow:"never"},{header:_(()=>[y("div",F,[i(n,{href:"https://github.com/SheetJS/sheetjs",target:"_blank",style:{margin:"0 5px 4px 0","font-size":"16px"}},{default:_(()=>t[0]||(t[0]=[f(" 导出Excel ",-1)])),_:1,__:[0]})]),i(n,{class:"mt-2",href:"https://github.com/pure-admin/vue-pure-admin/blob/main/src/views/able/excel.vue",target:"_blank"},{default:_(()=>t[1]||(t[1]=[f(" 代码位置 src/views/able/excel.vue ",-1)])),_:1,__:[1]})]),default:_(()=>[i(c,{type:"primary",onClick:$},{default:_(()=>t[2]||(t[2]=[f("导出Excel",-1)])),_:1,__:[2]}),y("div",J,[i(l,null,{default:_(({height:p,width:C})=>[i(a,{columns:g(d),data:g(b),width:C,height:p,fixed:""},null,8,["columns","data","width","height"])]),_:1})])]),_:1})}}});export{q as default};
