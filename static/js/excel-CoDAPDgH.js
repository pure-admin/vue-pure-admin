var E=Object.defineProperty,B=Object.defineProperties;var S=Object.getOwnPropertyDescriptors;var x=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var k=(s,e,o)=>e in s?E(s,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):s[e]=o,w=(s,e)=>{for(var o in e||(e={}))V.call(e,o)&&k(s,o,e[o]);if(x)for(var o of x(e))z.call(e,o)&&k(s,o,e[o]);return s},v=(s,e)=>B(s,S(e));import{u as h,w as K}from"./xlsx-DaVhO591.js";import{d as N,b as A,w as u,e as _,f as j,g as y,i as m,h as f,u as g}from"./index-B0Z6rV6K.js";const F={class:"font-medium"},J={class:"h-[25rem] mt-3"},q=N({name:"Excel",__name:"excel",setup(s){const e=(r=10,t="column-",n)=>Array.from({length:r}).map((c,a)=>v(w({},n),{key:`${t}${a}`,dataKey:`${t}${a}`,title:`Column ${a}`,width:150})),o=(r,t=200,n="row-")=>Array.from({length:t}).map((c,a)=>r.reduce((l,i,p)=>(l[i.dataKey]=`Row ${a} - Col ${p}`,l),{id:`${n}${a}`,parentId:null})),d=e(10),b=o(d,1e3),$=()=>{const r=b.map(a=>{const l=[];return d.forEach(i=>{l.push(a[i.dataKey])}),l}),t=[];d.forEach(a=>{t.push(a.title)}),r.unshift(t);const n=h.aoa_to_sheet(r),c=h.book_new();h.book_append_sheet(c,n,"数据报表"),K(c,"tableV2.xlsx")};return(r,t)=>{const n=_("el-link"),c=_("el-button"),a=_("el-table-v2"),l=_("el-auto-resizer"),i=_("el-card");return j(),A(i,{shadow:"never"},{header:u(()=>[y("div",F,[m(n,{href:"https://github.com/SheetJS/sheetjs",target:"_blank",style:{margin:"0 5px 4px 0","font-size":"16px"}},{default:u(()=>t[0]||(t[0]=[f(" 导出Excel ")])),_:1})]),m(n,{class:"mt-2",href:"https://github.com/pure-admin/vue-pure-admin/blob/main/src/views/able/excel.vue",target:"_blank"},{default:u(()=>t[1]||(t[1]=[f(" 代码位置 src/views/able/excel.vue ")])),_:1})]),default:u(()=>[m(c,{type:"primary",onClick:$},{default:u(()=>t[2]||(t[2]=[f("导出Excel")])),_:1}),y("div",J,[m(l,null,{default:u(({height:p,width:C})=>[m(a,{columns:g(d),data:g(b),width:C,height:p,fixed:""},null,8,["columns","data","width","height"])]),_:1})])]),_:1})}}});export{q as default};
